<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>

<div id="container" style="width:100%; height:400px;"></div>

<script>
$(function () {
	$.get( "http://localhost:8000/api/data/", function( data ) {

		var dataset = [];

		// format data for Highcharts
		$.each(data, function(key, value) {
			var date = new Date(value.created);
			dataset.push([date.getTime(), parseFloat(value.payload)]);
		});

		// display times in local timezone
		Highcharts.setOptions({
			global: {
				useUTC: false
			}
		})

		$('#container').highcharts({
			chart: {
				zoomType: 'x'
			},
			title: {
				text: 'Payload over Time'
			},
			subtitle: {
				text: document.ontouchstart === undefined ?
						'Click and drag in the plot area to zoom in' : 'Pinch the chart to zoom in'
			},
			xAxis: {
				type: 'datetime'
			},
			yAxis: {
				title: {
					text: 'Payload'
				}
			},
			legend: {
				enabled: false
			},
			plotOptions: {
				area: {
					fillColor: {
						linearGradient: {
							x1: 0,
							y1: 0,
							x2: 0,
							y2: 1
						},
						stops: [
							[0, Highcharts.getOptions().colors[0]],
							[1, Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get('rgba')]
						]
					},
					marker: {
						radius: 2
					},
					lineWidth: 1,
					states: {
						hover: {
							lineWidth: 1
						}
					},
					threshold: null
				}
			},

			series: [{
				type: 'area',
				name: 'Payload over Time',
				data: dataset
			}]
		});
	});
});
</script>